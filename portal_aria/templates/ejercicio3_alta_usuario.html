<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ titulo }}</title>
    <meta name="description" content="{{ descripcion }}">
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
        .registration-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem 0;
        }
        
        .registration-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin: 2rem auto;
            max-width: 1200px;
        }
        
        .form-section {
            padding: 2rem;
            border-bottom: 1px solid #e9ecef;
        }
        
        .form-section:last-child {
            border-bottom: none;
        }
        
        .form-progress {
            background: #f8f9fa;
            padding: 1rem 2rem;
        }
        
        .progress-bar-custom {
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007bff, #0056b3);
            transition: width 0.3s ease;
        }
        
        /* PROBLEMAS INTENCIONADOS */
        .required-field::after {
            content: " *";
            color: red;
        }
        
        .field-help {
            font-size: 0.8rem;
            color: #6c757d;
            margin-top: 0.25rem;
        }
        
        .radio-group {
            display: flex;
            gap: 1rem;
            margin-top: 0.5rem;
        }
        
        .checkbox-group {
            margin-top: 0.5rem;
        }
        
        .file-upload-area {
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload-area:hover {
            border-color: #007bff;
            background: #e7f3ff;
        }
        
        .range-display {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: #6c757d;
            margin-top: 0.25rem;
        }
        
        .character-counter {
            text-align: right;
            font-size: 0.8rem;
            color: #6c757d;
            margin-top: 0.25rem;
        }
        
        /* Problemas de contraste intencionados */
        .subtle-text {
            color: #636b71ff;
        }
        
        .validation-message {
            margin-top: 0.25rem;
            font-size: 0.8rem;
        }
        
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
    </style>
</head>

<body>
    <!-- Enlace para saltar al contenido principal (skip link) -->
    <a class="skip-link" href="#contenidoPrincipal" style="position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden;" onfocus="this.style.left='10px';this.style.top='10px';this.style.width='auto';this.style.height='auto';">Saltar al contenido</a>
    
    <div class="registration-container">
        <div class="container">
            
            <!-- Navegaci√≥n de regreso -->
            <div class="mb-3">
                <a href="{{ url_for('index') }}" class="btn btn-outline-light">
                    ‚Üê Volver al portal
                </a>
            </div>
            
            <div class="registration-card">
                
                <!-- Progreso con ARIA -->
                <div class="form-progress">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <div style="font-weight: 500; font-size: 1.2rem;">Registro de Usuario</div>
                        <div style="font-size: 0.9rem; color: #3e4448ff;">Paso 1 de 1</div>
                    </div>
                    <div class="progress-bar-custom">
                        <div id="barraProgresoFormulario" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="25" aria-label="Progreso del registro" class="progress-fill" style="width: 25%"></div>
                    </div>
                    <div style="margin-top: 0.5rem; font-size: 0.8rem; color: #3e4448ff;">
                        Completando informaci√≥n personal...
                    </div>
                </div>
                
                <!-- Formulario principal -->
                <form id="registrationForm" novalidate style="padding: 0;" role="form" aria-labelledby="tituloFormulario">
                    <h1 id="tituloFormulario" class="sr-only">Formulario de alta de usuario</h1>
                    
                    <!-- Secci√≥n 1: Informaci√≥n Personal -->
                    <fieldset class="form-section" id="seccionInformacionPersonal">
                        <legend style="font-size: 1.3rem; font-weight: 500; margin-bottom: 1.5rem; color: #0062cbff;">üìù Informaci√≥n Personal</legend>
                        
                        <div class="row">
                            <!-- Nombre completo -->
                            <div class="col-md-6 mb-3">
                                <!-- PROBLEMA: Label sin asociaci√≥n correcta -->
                                <label for="NombreCompleto" class="form-label required-field">Nombre completo</label>
                                <input type="text" 
                                       class="form-control" 
                                       name="fullName"
                                       placeholder="Ingresa tu nombre completo"
                                       maxlength="100"
                                       id="NombreCompleto"
                                       required="true"
                                       aria-required="true">
                                <div id="ContadorNombreCompleto" class="character-counter" aria-live="polite">0/100 caracteres</div>
                                <!-- Mensaje de ayuda asociado -->
                                <div class="field-help" id="AyudaNombreCompleto">
                                    Incluye tu nombre y apellidos completos
                                </div>
                            </div>
                            
                            <!-- Email -->
                            <div class="col-md-6 mb-3">
                                <label for="email" class="form-label required-field">Correo electr√≥nico</label>
                                <input type="email" 
                                       class="form-control" 
                                       name="email"
                                       placeholder="tu@email.com"
                                       autocomplete="email"
                                       id="email"
                                       required="true"
                                       aria-required="true">
                                <!-- Validaci√≥n en vivo accesible -->
                                <div id="ValidacionEmail" class="validation-message" aria-live="polite" style="display: none;"></div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <!-- Fecha de nacimiento -->
                            <div class="col-md-4 mb-3">
                                <label for="FechaNacimiento" class="form-label required-field">Fecha de nacimiento</label>
                                <input type="date" 
                                       class="form-control" 
                                       name="birthDate"
                                       max="2006-01-01"
                                       id="FechaNacimiento"
                                       required="true"
                                       aria-required="true">
                                <div class="field-help" id="AyudaFechaNacimiento">
                                    Debes ser mayor de 18 a√±os para registrarte
                                </div>
                            </div>
                            
                            <!-- Tel√©fono -->
                            <div class="col-md-4 mb-3">
                                <label for="Telefono" class="form-label required-field">Tel√©fono</label>
                                <input type="tel" 
                                       class="form-control" 
                                       name="phone"
                                       placeholder="+34 600 000 000"
                                       autocomplete="tel"
                                       id="Telefono"
                                       required="true"
                                       aria-required="true">
                                <div id="ValidacionTelefono" class="validation-message" aria-live="polite" style="display: none;"></div>
                            </div>
                            
                            <!-- Pa√≠s -->
                            <div class="col-md-4 mb-3">
                                <!-- PROBLEMA: Select sin label apropiado -->
                                <label for="Pais" class="form-label required-field">Pa√≠s</label>
                                <select class="form-select" name="country" id="Pais" required="true" aria-required="true" aria-describedby="AyudaPais">
                                    <!-- Opci√≥n por defecto marcada como placeholder -->
                                    <option value="" disabled selected hidden>Selecciona tu pa√≠s</option>
                                    <option value="ES">Espa√±a</option>
                                    <option value="MX">M√©xico</option>
                                    <option value="AR">Argentina</option>
                                    <option value="CO">Colombia</option>
                                    <option value="PE">Per√∫</option>
                                    <option value="CL">Chile</option>
                                    <option value="OTHER">Otro</option>
                                </select>
                            </div>
                        </div>
                    </fieldset>
                    
                    <!-- Secci√≥n 2: Informaci√≥n Profesional - PROBLEMAS -->
                    <fieldset class="form-section" id="seccionInformacionProfesional">
                        <legend style="font-size: 1.3rem; font-weight: 500; margin-bottom: 1.5rem; color: #0062cbff;">üíº Informaci√≥n Profesional</legend>
                        
                        <div class="row">
                            <!-- Ocupaci√≥n -->
                            <div class="col-md-6 mb-3">
                    <label for="OcupacionActual" class="form-label">Ocupaci√≥n actual</label>
                    <input id="OcupacionActual" type="text" 
                                       class="form-control" 
                                       name="occupation"
                                       placeholder="Ej: Desarrollador Frontend"
                                       list="occupationsList"
                                       required="true"
                                       aria-required="true">

                                <!-- Datalist: explicar con aria-describedby -->
                                <datalist id="occupationsList">
                                    <option value="Desarrollador Frontend">
                                    <option value="Desarrollador Backend">
                                    <option value="Full Stack Developer">
                                    <option value="DevOps Engineer">
                                    <option value="UX/UI Designer">
                                    <option value="Product Manager">
                                    <option value="Data Scientist">
                                    <option value="Estudiante">
                                </datalist>
                            </div>
                            
                            <!-- Experiencia -->
                            <div class="col-md-6 mb-3">
                    <label for="RangoExperiencia" class="form-label">A√±os de experiencia</label>
                    <!-- Range input con ARIA -->
                    <input id="RangoExperiencia" type="range" 
                                       class="form-range" 
                                       name="experience"
                                       min="0" 
                                       max="20" 
                                       value="2"
                                       step="1"
                                       required="true"
                                       aria-required="true"
                                       aria-valuemin="0" aria-valuemax="20" aria-valuenow="2" aria-describedby="ValorExperiencia">
                                <div class="range-display">
                                    <span>0 a√±os</span>
                                    <span id="ValorExperiencia">2 a√±os</span>
                                    <span>20+ a√±os</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Habilidades t√©cnicas - PROBLEMA: Checkboxes sin estructura -->
                            <div class="mb-3">
                            <fieldset id="grupoHabilidades">
                                <legend class="form-label">Habilidades t√©cnicas</legend>
                                <div class="field-help" id="AyudaHabilidadesTecnicas">Selecciona todas las que apliquen</div>
                            
                            <div class="checkbox-group">
                                <div class="row">
                                    <div class="col-md-3">
                                        <label><input type="checkbox" id="skill_html" name="skills" value="html" style="margin-right: 0.5rem;"> HTML/CSS</label>
                                    </div>
                                    <div class="col-md-3">
                                        <input type="checkbox" name="skills" value="javascript" style="margin-right: 0.5rem;">
                                        JavaScript
                                    </div>
                                    <div class="col-md-3">
                                        <input type="checkbox" name="skills" value="react" style="margin-right: 0.5rem;">
                                        React
                                    </div>
                                    <div class="col-md-3">
                                        <input type="checkbox" name="skills" value="vue" style="margin-right: 0.5rem;">
                                        Vue.js
                                    </div>
                                </div>
                                <div class="row mt-2">
                                    <div class="col-md-3">
                                        <input type="checkbox" name="skills" value="angular" style="margin-right: 0.5rem;">
                                        Angular
                                    </div>
                                    <div class="col-md-3">
                                        <input type="checkbox" name="skills" value="nodejs" style="margin-right: 0.5rem;">
                                        Node.js
                                    </div>
                                    <div class="col-md-3">
                                        <input type="checkbox" name="skills" value="python" style="margin-right: 0.5rem;">
                                        Python
                                    </div>
                                    <div class="col-md-3">
                                        <label><input type="checkbox" id="skill_other" name="skills" value="other" style="margin-right: 0.5rem;"> Otras</label>
                                    </div>
                                </div>
                            </fieldset>
                            </div>
                        </div>
                        
                        <!-- Salario esperado -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="form-label">Salario esperado (EUR/a√±o)</div>
                                <input type="number" 
                                       class="form-control" 
                                       name="expectedSalary"
                                       min="15000" 
                                       max="150000" 
                                       step="1000"
                                       placeholder="45000"
                                       required="true"
                                       aria-required="true">
                                <div class="field-help" id="SalarioEsperadoHelp" aria-describedby="SalarioEsperadoHelp">Rango entre ‚Ç¨15,000 y ‚Ç¨150,000</div>
                            </div>
                            
                            <!-- Disponibilidad -->
                            <div class="col-md-6 mb-3">
                                <fieldset id="grupoDisponibilidad">
                                    <legend class="form-label required-field">Disponibilidad para trabajar</legend>
                                    <div class="radio-group" role="radiogroup" aria-labelledby="grupoDisponibilidad">
                                        <label><input type="radio" id="disponibilidad_inmediata" name="availability" value="immediate" style="margin-right: 0.5rem;"> Inmediata</label>
                                        <label><input type="radio" id="disponibilidad_2semanas" name="availability" value="2weeks" style="margin-right: 0.5rem;"> 2 semanas</label>
                                        <label><input type="radio" id="disponibilidad_1mes" name="availability" value="1month" style="margin-right: 0.5rem;"> 1 mes</label>
                                        <label><input type="radio" id="disponibilidad_negociable" name="availability" value="negotiable" style="margin-right: 0.5rem;"> Negociable</label>
                                    </div>
                                </fieldset>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Secci√≥n 3: Preferencias y Configuraci√≥n - PROBLEMAS -->
                    <fieldset class="form-section" id="seccionPreferencias">
                        <legend style="font-size: 1.3rem; font-weight: 500; margin-bottom: 1.5rem; color: #0062cbff;">‚öôÔ∏è Preferencias y Configuraci√≥n</legend>
                        
                        <div class="row">
                            <!-- Idioma preferido -->
                            <div class="col-md-4 mb-3">
                                <div class="form-label">Idioma preferido</div>
                                <select class="form-select" name="preferredLanguage">
                                    <option value="es" selected>Espa√±ol</option>
                                    <option value="en">English</option>
                                    <option value="fr">Fran√ßais</option>
                                    <option value="de">Deutsch</option>
                                    <option value="pt">Portugu√™s</option>
                                </select>
                            </div>
                            
                            <!-- Zona horaria -->
                            <div class="col-md-4 mb-3">
                                <div class="form-label">Zona horaria</div>
                                <select class="form-select" name="timezone">
                                    <option value="">Detectar autom√°ticamente</option>
                                    <option value="Europe/Madrid">Europa/Madrid (CET)</option>
                                    <option value="America/Mexico_City">Am√©rica/Ciudad_de_M√©xico</option>
                                    <option value="America/New_York">Am√©rica/Nueva_York (EST)</option>
                                    <option value="America/Los_Angeles">Am√©rica/Los_√Ångeles (PST)</option>
                                </select>
                            </div>
                            
                            <!-- Tema preferido -->
                            <div class="col-md-4 mb-3">
                                <fieldset id="grupoTema">
                                    <legend class="form-label">Tema de interfaz</legend>
                                    <div style="margin-top: 0.5rem;">
                                        <label><input type="radio" id="tema_claro" name="theme" value="light" checked style="margin-right: 0.5rem;"> Claro</label>
                                        <label><input type="radio" id="tema_oscuro" name="theme" value="dark" style="margin-left: 1rem; margin-right: 0.5rem;"> Oscuro</label>
                                        <label><input type="radio" id="tema_auto" name="theme" value="auto" style="margin-left: 1rem; margin-right: 0.5rem;"> Autom√°tico</label>
                                    </div>
                                </fieldset>
                            </div>
                        </div>
                        
                        <!-- Notificaciones - PROBLEMA: Sin fieldset -->
                        <div class="mb-3">
                            <div class="form-label">Preferencias de notificaciones</div>
                            <div class="checkbox-group">
                                <div class="mb-2">
                                    <input type="checkbox" name="notifications" value="email" checked style="margin-right: 0.5rem;">
                                    Recibir notificaciones por email
                                </div>
                                <div class="mb-2">
                                    <input type="checkbox" name="notifications" value="sms" style="margin-right: 0.5rem;">
                                    Recibir notificaciones por SMS
                                </div>
                                <div class="mb-2">
                                    <input type="checkbox" name="notifications" value="push" checked style="margin-right: 0.5rem;">
                                    Recibir notificaciones push
                                </div>
                                <div class="mb-2">
                                    <input type="checkbox" name="notifications" value="newsletter" checked style="margin-right: 0.5rem;">
                                    Suscribirse al newsletter semanal
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bio/Descripci√≥n -->
                        <div class="mb-3">
                            <label for="Biografia" class="form-label">Biograf√≠a o descripci√≥n personal</label>
                            <textarea id="Biografia" class="form-control" 
                                      name="bio"
                                      rows="4"
                                      maxlength="500"
                                      placeholder="Cu√©ntanos un poco sobre ti, tus intereses profesionales y objetivos..." aria-describedby="ContadorBiografia AyudaBiografia"></textarea>
                            <div id="ContadorBiografia" class="character-counter" aria-live="polite">0/500 caracteres</div>
                            <div class="field-help" id="AyudaBiografia">
                                Esta informaci√≥n aparecer√° en tu perfil p√∫blico
                            </div>
                        </div>
                    </div>
                    
                    <!-- Secci√≥n 4: Documentos y Archivos - PROBLEMAS CR√çTICOS -->
                    <div class="form-section">
                        <div style="font-size: 1.3rem; font-weight: 500; margin-bottom: 1.5rem; color: #0062cbff;">
                            üìé Documentos y Archivos
                        </div>
                        
                        <!-- CV/Curr√≠culum -->
                        <div class="mb-4">
                            <div class="form-label">Curr√≠culum Vitae (CV)</div>
                            <!-- Input file accesible: label focusable vinculado al input oculto -->
                            <label for="ArchivoCV" class="file-upload-area" id="AreaSubidaCV" tabindex="0" role="button" aria-describedby="AyudaCV" onkeydown="if(event.key==='Enter' || event.key===' ') { document.getElementById('ArchivoCV').click(); event.preventDefault(); }">
                                <div style="font-size: 2rem; margin-bottom: 1rem;">üìÑ</div>
                                <div style="font-weight: 500;">Haz clic o pulsa Enter para subir tu CV</div>
                                <div class="subtle-text" style="margin-top: 0.5rem;">
                                    Formatos admitidos: PDF, DOC, DOCX (m√°x. 5MB)
                                </div>
                            </label>
                            <input type="file" 
                                   id="ArchivoCV"
                                   name="cv"
                                   accept=".pdf,.doc,.docx"
                                   aria-describedby="AyudaCV" style="position:absolute; left:-9999px;">
                            <div class="field-help" id="AyudaCV">
                                Tu CV nos ayuda a entender mejor tu experiencia profesional
                            </div>
                        </div>
                        
                        <!-- Foto de perfil -->
                        <div class="mb-4">
                            <div class="form-label">Foto de perfil (opcional)</div>
                            <label for="FotoPerfil" class="file-upload-area" id="AreaSubidaFoto" tabindex="0" role="button" aria-describedby="AyudaFoto" onkeydown="if(event.key==='Enter' || event.key===' ') { document.getElementById('FotoPerfil').click(); event.preventDefault(); }">
                                <div style="font-size: 2rem; margin-bottom: 1rem;">üì∑</div>
                                <div style="font-weight: 500;">Subir foto de perfil</div>
                                <div class="subtle-text" style="margin-top: 0.5rem;">
                                    JPG, PNG (m√°x. 2MB, recomendado: 400x400px)
                                </div>
                            </label>
                            <input type="file" 
                                   id="FotoPerfil"
                                   name="profilePhoto"
                                   accept="image/*"
                                   aria-describedby="AyudaFoto" style="position:absolute; left:-9999px;">
                            <div class="field-help" id="AyudaFoto">Recomendado 400x400px</div>
                        </div>
                        
                        <!-- Portfolio/Enlaces -->
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="form-label">Portfolio web</div>
                                <input type="url" 
                                       class="form-control" 
                                       name="portfolio"
                                       placeholder="https://tu-portfolio.com">
                                <div class="field-help" id="PortfolioHelp" aria-describedby="PortfolioHelp">
                                    Enlace a tu portfolio o sitio web personal
                                </div>
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <div class="form-label">Perfil de LinkedIn</div>
                                <input type="url" 
                                       class="form-control" 
                                       name="linkedin"
                                       placeholder="https://linkedin.com/in/tu-perfil">
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="form-label">GitHub/GitLab</div>
                                <input type="url" 
                                       class="form-control" 
                                       name="github"
                                       placeholder="https://github.com/tu-usuario">
                            </div>
                            
                            <div class="col-md-6 mb-3">
                                <div class="form-label">Otro enlace relevante</div>
                                <input type="url" 
                                       class="form-control" 
                                       name="otherLink"
                                       placeholder="https://...">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Secci√≥n 5: T√©rminos y Confirmaci√≥n - PROBLEMAS -->
                    <div class="form-section">
                        <div style="font-size: 1.3rem; font-weight: 500; margin-bottom: 1.5rem; color: #0062cbff;">
                            ‚úÖ Confirmaci√≥n y T√©rminos
                        </div>
                        
                        <!-- PROBLEMA: Checkboxes legales sin fieldset -->
                        <fieldset class="mb-3" id="grupoLegales">
                            <legend class="form-label">T√©rminos y confirmaciones</legend>
                            <div class="checkbox-group">
                                <div class="mb-3">
                                    <input id="AceptoTerminos" type="checkbox" name="agreeTerms" required aria-required="true" style="margin-right: 0.5rem;">
                                    <label for="AceptoTerminos"><span>Acepto los <a href="#" target="_blank" rel="noopener noreferrer" aria-label="T√©rminos y condiciones (se abre en ventana nueva)">t√©rminos y condiciones de uso</a> del servicio</span></label>
                                </div>
                                
                                <div class="mb-3">
                                    <input type="checkbox" name="agreePrivacy" required style="margin-right: 0.5rem;">
                                    <span>
                                        He le√≠do y acepto la 
                                        <a href="#" target="_blank">pol√≠tica de privacidad</a>
                                    </span>
                                </div>
                                
                                <div class="mb-3">
                                    <input type="checkbox" name="agreeMarketing" style="margin-right: 0.5rem;">
                                    <span>
                                        Acepto recibir comunicaciones comerciales y marketing 
                                        (opcional)
                                    </span>
                                </div>
                                
                                <div class="mb-3">
                                    <input id="ConfirmoEdad" type="checkbox" name="confirmAge" required aria-required="true" style="margin-right: 0.5rem;">
                                    <label for="ConfirmoEdad">Confirmo que soy mayor de 18 a√±os</label>
                                </div>
                            </div>
                        </fieldset>
                        
                        <!-- Verificaci√≥n final -->
                        <div id="AvisoVerificacion" class="mb-4 p-3" style="background: #f8f9fa; border-radius: 8px; border-left: 4px solid #007bff;">
                            <div style="font-weight: 500; margin-bottom: 0.5rem;">
                                ‚ö†Ô∏è Verificaci√≥n final
                            </div>
                            <div style="font-size: 0.9rem;">
                                Por favor, revisa todos los datos ingresados antes de enviar el formulario. 
                                Una vez registrado, algunos campos no podr√°n modificarse.
                            </div>
                        </div>
                        
                        <!-- Botones de acci√≥n - PROBLEMA -->
                        <div style="display: flex; gap: 1rem; justify-content: end;">
                            <button id="BotonLimpiar" type="button" class="btn btn-outline-secondary">
                                Limpiar formulario
                            </button>
                            <button id="BotonBorrador" type="button" class="btn btn-secondary">
                                Guardar como borrador
                            </button>
                            <!-- Bot√≥n submit con atributos para estado -->
                            <button id="BotonEnviar" type="submit" class="btn btn-primary" aria-describedby="AvisoVerificacion">
                                Completar registro
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Overlay accesible para env√≠o -->
    <div id="submitOverlay" role="dialog" aria-modal="true" aria-hidden="true" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: none; justify-content: center; align-items: center; z-index: 9999;">
        <div id="ContenidoOverlay" tabindex="-1" style="background: white; padding: 2rem; border-radius: 10px; text-align: center;">
            <div class="spinner-border text-primary mb-3" role="status" aria-hidden="true"></div>
            <div id="TextoOverlay">Procesando registro...</div>
            <div id="SubtextoOverlay" style="font-size: 0.8rem; color: #6c757d; margin-top: 0.5rem;">Esto puede tomar unos segundos</div>
        </div>
    </div>
    
    <!-- Area visual de mensajes y regi√≥n para lectores de pantalla -->
    <div id="messageArea" style="position: fixed; top: 20px; right: 20px; z-index: 10000; max-width: 400px;"></div>
    <div id="srNotifications" aria-live="polite" aria-atomic="true" class="sr-only"></div>

    <style>
        /* Focus visible para elementos custom */
        .file-upload-area:focus {
            outline: 3px solid #0056b3;
            outline-offset: 2px;
        }
        .skip-link:focus {
            position: absolute !important;
            left: 10px !important;
            top: 10px !important;
            background: #fff;
            padding: 6px 8px;
            z-index: 2000;
            border-radius: 4px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }
        .sr-only { position: absolute !important; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }
    </style>
    
    <script src="{{ url_for('static', filename='js/portal.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // PROBLEMAS INTENCIONADOS EN EL JAVASCRIPT
        
        let formProgress = 25;
        let isSubmitting = false;
        
        // Contadores de caracteres con aria-live
        function updateCharacterCounter(input, maxLength) {
            const counter = input.parentNode.querySelector('.character-counter');
            if (counter) {
                const currentLength = input.value.length;
                counter.textContent = `${currentLength}/${maxLength} caracteres`;
                
                // PROBLEMA: No anuncia cuando se acerca al l√≠mite
                if (currentLength >= maxLength * 0.9) {
                    counter.style.color = '#dc3545';
                    // anunciar en srNotifications
                    const sr = document.getElementById('srNotifications');
                    if (sr) sr.textContent = `Atenci√≥n: te quedan ${maxLength - currentLength} caracteres`;
                } else {
                    counter.style.color = '#6c757d';
                }
            }
        }
        
        // PROBLEMA: Validaci√≥n de email sin feedback accesible
        function validateEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }
        
        // PROBLEMA: Validaci√≥n en tiempo real problem√°tica
        function showFieldValidation(fieldName, isValid, message) {
            const field = document.querySelector(`[name="${fieldName}"]`);
            const validationDiv = field.parentNode.querySelector('.validation-message');
            
            if (validationDiv) {
                validationDiv.style.display = 'block';
                validationDiv.className = `validation-message ${isValid ? 'success' : 'error'}`;
                validationDiv.textContent = message;
                
                // Asociar mensaje con el campo y usar aria-invalid
                const idError = fieldName + 'Error';
                validationDiv.id = idError;
                field.setAttribute('aria-describedby', (field.getAttribute('aria-describedby') || '') + ' ' + idError);
                if (!isValid) {
                    field.setAttribute('aria-invalid','true');
                    validationDiv.setAttribute('role','alert');
                    // anunciar globalmente
                    const sr = document.getElementById('srNotifications'); if (sr) sr.textContent = message;
                } else {
                    field.removeAttribute('aria-invalid');
                }
            }
        }
        
        // PROBLEMA: Actualizar progreso sin accesibilidad
        function updateProgress(percentage) {
            const progressBar = document.querySelector('.progress-fill');
            progressBar.style.width = percentage + '%';
            // actualizar aria attributes
            const progres = document.getElementById('barraProgresoFormulario');
            if (progres) {
                progres.setAttribute('aria-valuenow', percentage);
                progres.setAttribute('aria-valuetext', percentage + '% completado');
            }
            const sr = document.getElementById('srNotifications'); if (sr) sr.textContent = `Progreso: ${percentage}%`;
        }
        
        // PROBLEMA: Manejo de archivos sin accesibilidad
        function handleFileUpload(input, maxSize) {
            const file = input.files[0];
            if (!file) return;
            
            const uploadArea = input.parentNode;
            
            if (file.size > maxSize) {
                // Error accesible
                const msg = 'El archivo es muy grande';
                const sr = document.getElementById('srNotifications'); if (sr) sr.textContent = msg;
                const errorDiv = document.createElement('div'); errorDiv.className = 'validation-message error'; errorDiv.setAttribute('role','alert'); errorDiv.textContent = msg;
                uploadArea.appendChild(errorDiv);
                input.value = '';
                return;
            }
            
            // PROBLEMA: Cambio visual sin anuncio
            uploadArea.style.background = '#d4edda';
            // actualizar visual y anunciar
            const primerDiv = uploadArea.querySelector('div');
            if (primerDiv) primerDiv.innerHTML = `‚úÖ ${file.name}`;
            const sr = document.getElementById('srNotifications'); if (sr) sr.textContent = `Archivo cargado: ${file.name}`;
        }
        
        // PROBLEMA: Mostrar mensajes no accesibles
        function showMessage(message, type = 'success') {
            const messageArea = document.getElementById('messageArea');
            const messageDiv = document.createElement('div');
            
            messageDiv.className = `alert alert-${type} alert-dismissible`;
            messageDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" onclick="this.parentElement.remove()"></button>
            `;
            
            messageArea.appendChild(messageDiv);
            // anunciar a SR
            const sr = document.getElementById('srNotifications'); if (sr) sr.textContent = message;
            setTimeout(() => { messageDiv.remove(); }, 5000);
        }
        
        // Configuraci√≥n del formulario - M√öLTIPLES PROBLEMAS
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('registrationForm');
            
            // PROBLEMA: Listeners sin manejo de accesibilidad
            
            // Contadores de caracteres
            document.querySelectorAll('input[maxlength], textarea[maxlength]').forEach(input => {
                const maxLength = input.getAttribute('maxlength');
                updateCharacterCounter(input, maxLength);
                
                input.addEventListener('input', () => {
                    updateCharacterCounter(input, maxLength);
                });
            });
            
            // Validaci√≥n de email en tiempo real - PROBLEM√ÅTICA
            const emailField = document.querySelector('[name="email"]');
            emailField.addEventListener('blur', function() {
                const isValid = validateEmail(this.value);
                if (this.value) {
                    showFieldValidation('email', isValid, 
                        isValid ? 'Email v√°lido' : 'Formato de email incorrecto');
                }
            });
            
            // Range slider - PROBLEMA: Sin descripci√≥n accesible
            const experienceRange = document.querySelector('[name="experience"]');
            const experienceValue = document.getElementById('ValorExperiencia');
            
            experienceRange.addEventListener('input', function() {
                experienceValue.textContent = `${this.value} a√±os`;
                this.setAttribute('aria-valuenow', this.value);
                this.setAttribute('aria-valuetext', `${this.value} a√±os`);
                const sr = document.getElementById('srNotifications'); if (sr) sr.textContent = `A√±os de experiencia: ${this.value}`;
            });
            
            // File inputs - PROBLEMAS DE ACCESIBILIDAD
            document.getElementById('ArchivoCV').addEventListener('change', function() { handleFileUpload(this, 5 * 1024 * 1024); });
            document.getElementById('FotoPerfil').addEventListener('change', function() { handleFileUpload(this, 2 * 1024 * 1024); });
            
            // Env√≠o del formulario - M√öLTIPLES PROBLEMAS
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (isSubmitting) return;
                
                // PROBLEMA: Validaci√≥n b√°sica sin accesibilidad
                const requiredFields = form.querySelectorAll('[required], .required-field ~ input, .required-field ~ select');
                let hasErrors = false;
                
                requiredFields.forEach(field => {
                    if (!field.value.trim()) {
                        // Error accesible: marcar aria-invalid y acumular
                        field.style.borderColor = '#dc3545';
                        field.setAttribute('aria-invalid','true');
                        hasErrors = true;
                    } else {
                        field.style.borderColor = '';
                        field.removeAttribute('aria-invalid');
                    }
                });
                
                if (hasErrors) {
                    // enfocar primer error y anunciar
                    const primerError = form.querySelector('[aria-invalid="true"]');
                    if (primerError) { primerError.focus(); }
                    showMessage('Por favor completa todos los campos requeridos', 'danger');
                    return;
                }
                
                // PROBLEMA: Loading sin accesibilidad
                isSubmitting = true;
                const overlay = document.getElementById('submitOverlay');
                overlay.style.display = 'flex'; overlay.setAttribute('aria-hidden','false');
                const contenidoOverlay = document.getElementById('ContenidoOverlay'); if (contenidoOverlay) contenidoOverlay.focus();
                
                // Simular env√≠o
                setTimeout(() => {
                    overlay.style.display = 'none'; overlay.setAttribute('aria-hidden','true');
                    isSubmitting = false;
                    
                    if (Math.random() > 0.2) {
                        showMessage('¬°Registro completado exitosamente! Te hemos enviado un email de confirmaci√≥n.', 'success');
                        setTimeout(() => {
                            window.location.href = '/';
                        }, 3000);
                    } else {
                        showMessage('Error al procesar el registro. Int√©ntalo de nuevo.', 'danger');
                    }
                }, 3000);
            });
            
            // PROBLEMA: Botones sin manejo de teclado apropiado
            document.getElementById('BotonLimpiar').addEventListener('click', function() {
                if (confirm('¬øEst√°s seguro de que quieres limpiar el formulario?')) {
                    form.reset();
                    const sr = document.getElementById('srNotifications'); if (sr) sr.textContent = 'Formulario limpiado';
                    document.getElementById('NombreCompleto').focus();
                }
            });
        });
    </script>
    
</body>
</html>

<!--
PROBLEMAS CR√çTICOS DE ACCESIBILIDAD PARA CORREGIR:

ESTRUCTURA DE FORMULARIO:
1. ‚úó Falta fieldset/legend para agrupar secciones relacionadas
2. ‚úó Labels no asociados correctamente (sin for/id)
3. ‚úó Campos requeridos sin aria-required
4. ‚úó Mensajes de ayuda sin aria-describedby
5. ‚úó Validaciones sin aria-invalid

GRUPOS DE CAMPOS:
6. ‚úó Radio buttons sin fieldset/legend
7. ‚úó Checkboxes sin fieldset para agrupar opciones relacionadas
8. ‚úó Grupo de habilidades sin estructura sem√°ntica

ELEMENTOS COMPLEJOS:
9. ‚úó Range input sin aria-valuetext descriptivo
10. ‚úó File inputs sin accesibilidad (ocultos con divs clickeables)
11. ‚úó Datalist sin aria-describedby
12. ‚úó Select options por defecto problem√°ticas

FEEDBACK Y VALIDACI√ìN:
13. ‚úó Mensajes de error no asociados con campos
14. ‚úó Validaci√≥n en tiempo real sin aria-live
15. ‚úó Contadores de caracteres no anunciados
16. ‚úó Estados de validaci√≥n sin aria-invalid
17. ‚úó Progreso del formulario no accesible

CONTENIDO DIN√ÅMICO:
18. ‚úó Subida de archivos sin feedback accesible
19. ‚úó Cambios de estado no anunciados
20. ‚úó Loading overlay sin manejo de foco
21. ‚úó Mensajes de √©xito/error no anunciados

NAVEGACI√ìN Y INTERACCI√ìN:
22. ‚úó Campos obligatorios no claramente identificados
23. ‚úó Enlaces externos sin indicaci√≥n
24. ‚úó Botones de acci√≥n sin descripci√≥n de proceso
25. ‚úó Falta navegaci√≥n con teclado entre secciones

INFORMACI√ìN CONTEXTUAL:
26. ‚úó Ayudas contextuales no asociadas
27. ‚úó Restricciones de formato sin describir
28. ‚úó L√≠mites de archivos no accesibles
29. ‚úó T√©rminos legales sin estructura apropiada

PROBLEMAS T√âCNICOS:
30. ‚úó Contraste insuficiente en textos secundarios
31. ‚úó Focus no visible en elementos custom
32. ‚úó Skip links ausentes para navegaci√≥n
33. ‚úó Roles ARIA faltantes para elementos complejos

El equipo debe implementar:
- fieldset/legend para agrupar campos relacionados
- Asociaciones correctas label/input (for/id)
- aria-required para campos obligatorios
- aria-describedby para mensajes de ayuda y error
- aria-invalid para estados de validaci√≥n
- aria-live regions para feedback din√°mico
- aria-valuetext para ranges
- Alternativas accesibles para file uploads
- Manejo apropiado de foco
- Anuncios de cambios de estado
- Navegaci√≥n con teclado mejorada
- Indicadores claros de campos requeridos
-->